# 数据库迁移指南

## 更新数据库 Schema

由于添加了套餐功能，需要运行数据库迁移来创建 `Package` 表。

### 步骤

1. **生成 Prisma Client**（如果还没有）：
   ```bash
   npx prisma generate
   ```

2. **创建迁移**：
   ```bash
   npx prisma migrate dev --name add_package_model
   ```

   这将：
   - 创建 `Package` 表
   - 在 `Order` 表中添加 `packageId` 字段

3. **如果是在生产环境**，使用：
   ```bash
   npx prisma migrate deploy
   ```

## 功能说明

### 套餐管理

1. **访问套餐管理页面**：
   - 登录后台：`http://localhost:3000/admin/login`
   - 点击"套餐管理"或访问：`http://localhost:3000/admin/packages`

2. **创建套餐**：
   - 点击"创建套餐"按钮
   - 填写套餐信息：
     - 套餐名称（必填）
     - 套餐描述（可选）
     - 套餐价格（必填）
     - 图片URL（可选）
     - 排序顺序
     - 状态（启用/禁用）
   - 添加商品列表：
     - 商品名称
     - 单价
     - 数量
   - 点击"创建"保存

3. **编辑套餐**：
   - 在套餐卡片上点击"编辑"按钮
   - 修改信息后点击"保存"

4. **删除套餐**：
   - 在套餐卡片上点击"删除"按钮
   - 确认删除

### 前台下单

- 用户访问下单页面时，只会看到**已启用**的套餐
- 用户可以选择多个套餐，每个套餐可以设置数量
- 提交订单时，系统会将套餐中的所有商品展开为订单项

### 订单关联

- 如果用户只选择了一个套餐，订单会关联该套餐ID
- 如果用户选择了多个套餐，订单不会关联套餐ID（packageId 为 null）

